name: CIS_NGFW_benchmark
label: CIS NGFW benchmarks

description: |
  Use CIS CSC benchmarks for system validations

type: pan_validation
labels:
  collection:
    - CIS
    - Benchmark
    - Validation

variables:

snippets:

  # 1.1.1.1 system logging configured
  # TODO: look at each granular piece: log types and log forwarding options
  # TODO: may require multiple tests for full assessment
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: system_logging_entries
        capture_list: /config/shared/log-settings/system/match-list/entry/@name

  - name: system_logging_configured
    label: 1.1.1.1 Syslog logging should be configured
    test: system_logging_entries | length
    fail_message: no system logging configured
    pass_message: I see system logging configured
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.1.1.2 snmpv3 traps configured
  # TODO: look at each granular piece: log types and log forwarding options
  # TODO: may require multiple tests for full assessment
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: snmpv3_traps
        capture_object: /config/shared/log-settings/system/match-list/entry/@name

  - name: snmpv3_traps_configured
    label: 1.1.1.2 SNMPv3 traps should be configured
    test: snmpv3_traps | length
    fail_message: no snmp system logging configured
    pass_message: system logging configured using snmp traps
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.1.2 login banner set
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: login_banner
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/system/login-banner

  - name: login_banner_set
    label: 1.1.2 Ensure 'Login Banner' is set
    test: login_banner | tag_present('login-banner')
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.1.3 log on high dp load
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: enable_log_high_dp_load
    label: 1.1.3 Ensure 'Enable Log on High DP Load' is enabled
    test: device_setting | element_value('management.enable-log-high-dp-load') == 'yes'
    documentation_link: https://iron-skillet.readthedocs.io/en/docs_dev/viz_guide_panos.html#device-setup-management-logging-and-reporting-settings

  # 1.2.1 permitted ip addresses for device management
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: mgmt_permitted_ips
        capture_list: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/system/permitted-ip/entry/@name

  - name: permitted_ip_addresses_mgmt
    label: 1.2.1 Ensure 'Permitted IP Addresses' is set to those necessary for device management
    test: mgmt_permitted_ips | length
    fail_message: no permitted IP addresses configured for the management interface
    pass_message: permitted IP addresses configured
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.2.2 permitted ip addresses for management profiles
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: profile_permitted_ips
        capture_list: /config/devices/entry[@name='localhost.localdomain']/network/profiles/interface-management-profile/entry/permitted-ip/../@name

  - name: permitted_ip_address_mgmt_profiles
    label: 1.2.2 Ensure 'Permitted IP Addresses' is set for all management profiles where SSH, HTTPS, or SNMP is enabled
    test: profile_permitted_ips | length
    fail_message: should have permitted IPs
    pass_message: permitted IPs found
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.2.3 disable http and telment for mgmt interface
  # TODO: look at defaults vs configured to capture outputs and test properly
  # TODO: do both http and telnet as 2 captures and conditional in the test
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: mgmt_disable_http
        capture_value: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/system/service/disable-http/text()

  - name: http_telnet_disabled_mgmt
    label: 1.2.3 Ensure HTTP and Telnet options are disabled for the management interface
    test: mgmt_disable_http != 'no'
    fail_message: http not disabled
    pass_message: http is disabled
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.2.4 disable http and telnet for mgmt profiles
  # TODO: look at defaults vs configured to capture outputs and test properly
  # TODO: telnet and http checks
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: http_telnet_disabled_profiles
        capture_list: /config/devices/entry[@name='localhost.localdomain']/network/profiles/interface-management-profile/entry/http/../@name

  - name: http_telnet_disabled_mgmt_profiles
    label: 1.2.4 Ensure HTTP and Telnet options are disabled for all management profiles
    test: http_telnet_disabled_profiles | length
    fail_message: http not disabled
    pass_message: http disabled
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.2.5 valid cert set for UI admin intf
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: ssl_profiles
        capture_list: /config/shared/ssl-tls-service-profile/entry/@name

  - name: valid_cert_admin_intf
    label: 1.2.5 Ensure valid certificate is set for browser-based administrator interface
    test: ssl_profiles | length
    documentation_link: https://iron-skillet.readthedocs.io

  # object used for all password complexity validations
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: password_complexity
        capture_object: /config/mgt-config/password-complexity

  # 1.3.1 enable min password complexity
  - name: enable_min_pasword_complexity
    label: 1.3.1 Ensure 'Minimum Password Complexity' is enabled
    test: password_complexity | element_value('enabled') == 'yes'
    documentation_link: https://iron-skillet.readthedocs.io/en/docs_dev/viz_guide_panos.html#device-setup-management-minimum-password-complexity

  # 1.3.2 password complexity min length
  - name: password_complexity_min_length
    label: 1.3.2 Ensure 'Minimum Length' is greater than or equal to 12
    test: password_complexity | element_value('minimum-length') >= '12'
    documentation_link: https://iron-skillet.readthedocs.io/en/docs_dev/viz_guide_panos.html#device-setup-management-minimum-password-complexity

  # 1.3.3 password complexity min uppercase
  - name: password_complexity_min_uppercase
    label: 1.3.3 Ensure 'Minimum Uppercase Letters' is greater than or equal to 1
    test: password_complexity | element_value('minimum-uppercase-letters') >= '1'
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.4 password complexity min lowercase
  - name: password_complexity_min_lowercase
    label: 1.3.4 Ensure 'Minimum Lowercase Letters' is greater than or equal to 1
    test: password_complexity | element_value('minimum-lowercase-letters') >= '1'
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.5 password complexity min numeric
  - name: password_complexity_min_numeric
    label: 1.3.5 Ensure 'Minimum Numeric Letters' is greater than or equal to 1
    test: password_complexity | element_value('minimum-numeric-letters') >= '1'
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.6 password complexity min specials chars
  - name: password_complexity_min_special_char
    label: 1.3.6 Ensure 'Minimum Special Characters' is greater than or equal to 1
    test: password_complexity | element_value('minimum-special-characters') >= '1'
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.7 password complexity change period
  - name: password_complexity_max_change_period
    label: 1.3.7 Ensure 'Required Password Change Period' is less than or equal to 90 days
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.8 password complexity new password differs by char
  - name: password_complexity_new_differs
    label: 1.3.8 Ensure 'New Password Differs By Characters' is greater than or equal to 3
    test: password_complexity | element_value('new-password-differs-by-characters') >= '3'
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.9 password complexity password reuse limit
  - name: password_complexity_reuse_limit
    label: 1.3.9 Ensure 'Prevent Password Reuse Limit' is set to 24 or more passwords
    test: password_complexity | element_value('password-history-count') >= '24'
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.3.10 password profiles do not exist
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: no_password_profiles
    label: 1.3.10 Ensure 'Password Profiles' do not exist
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.4.1 admin idle timeout
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: max_idle_timeout
    label: 1.4.1 Ensure 'Idle timeout' is less than or equal to 10 minutes for device management
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.4.2 admin failed attempts and lockout
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: failed_attempts_lockout
    label: 1.4.2 Ensure 'Failed Attempts' and 'Lockout Time' for Authentication Profile are properly configured
    test: false
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.5.1 use snmpv3 for polling
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: snmpv3_selected
    label: 1.5.1 Ensure 'V3' is selected for SNMP polling
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.6.1 Ensure 'Verify Update Server Identity' is enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 1.6.1 Ensure 'Verify Update Server Identity' is enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.6.2 Ensure redundant NTP servers are configured appropriately
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 1.6.2 Ensure redundant NTP servers are configured appropriately
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 1.6.3 Ensure that the Certificate Securing Remote Access VPNs is Valid
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 1.6.3 Ensure that the Certificate Securing Remote Access VPNs is Valid
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.1 Ensure that IP addresses are mapped to usernames
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.1 Ensure that IP addresses are mapped to usernames
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.2 Ensure that WMI probing is disabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.2 Ensure that WMI probing is disabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.3 Ensure that User-ID is only enabled for internal trusted interfaces
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.3 Ensure that User-ID is only enabled for internal trusted interfaces
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.4 Ensure that 'Include/Exclude Networks' is used if User-ID is enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.4 Ensure that 'Include/Exclude Networks' is used if User-ID is enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.5 Ensure that the User-ID Agent has minimal permissions if User-ID is enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.5 Ensure that the User-ID Agent has minimal permissions if User-ID is enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.6 Ensure that the User-ID service account does not have interactive logon rights
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.6 Ensure that the User-ID service account does not have interactive logon rights
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.7 Ensure remote access capabilities for the User-ID service account are forbidden
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.7 Ensure remote access capabilities for the User-ID service account are forbidden
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 2.8 Ensure that security policies restrict User-ID Agent traffic from crossing into untrusted zones
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 2.8 Ensure that security policies restrict User-ID Agent traffic from crossing into untrusted zones
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 3.1 Ensure a fully-synchronized High Availability peer is configured
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 3.1 Ensure a fully-synchronized High Availability peer is configured
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 3.2 Ensure 'High Availability' requires Link Monitoring and/or Path Monitoring
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 3.2 Ensure 'High Availability' requires Link Monitoring and/or Path Monitoring
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 3.3 Ensure 'Passive Link State' and 'Preemptive' are configured appropriately
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 3.3 Ensure 'Passive Link State' and 'Preemptive' are configured appropriately
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 4.1 Ensure 'Antivirus Update Schedule' is set to download and install updates hourly
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 4.1 Ensure 'Antivirus Update Schedule' is set to download and install updates hourly
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 5.1 Ensure that WildFire file size upload limits are maximized
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 5.1 Ensure that WildFire file size upload limits are maximized
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 5.2 Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 5.2 Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 5.4 Ensure forwarding of decrypted content to WildFire is enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 5.4 Ensure forwarding of decrypted content to WildFire is enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 5.5 Ensure all WildFire session information settings are enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 5.5 Ensure all WildFire session information settings are enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 5.6 Ensure alerts are enabled for malicious files detected by WildFire
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 5.6 Ensure alerts are enabled for malicious files detected by WildFire
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 5.7 Ensure 'WildFire Update Schedule' is set to download and install updates every minute
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 5.7 Ensure 'WildFire Update Schedule' is set to download and install updates every minute
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.1 Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3'
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.1 Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3'
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.2 Ensure a secure antivirus profile is applied to all relevant security policies
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.2 Ensure a secure antivirus profile is applied to all relevant security policies
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.3 Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.3 Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.4 Ensure DNS sinkholing is configured on all anti-spyware profiles in use
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.4 Ensure DNS sinkholing is configured on all anti-spyware profiles in use
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.5 Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.5 Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.6 Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.6 Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.7 Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities,
  # and set to default on medium, low, and informational vulnerabilities
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: |
      6.7 Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities,
      and set to default on medium, low, and informational vulnerabilities
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.8 Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.8 Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.9 Ensure that PAN-DB URL Filtering is used
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.9 Ensure that PAN-DB URL Filtering is used
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.10 Ensure that URL Filtering uses the action of “block” or “override” on the URL categories
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.10 Ensure that URL Filtering uses the action of “block” or “override” on the URL categories
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.11 Ensure that access to every URL is logged
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.11 Ensure that access to every URL is logged
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.12 Ensure all HTTP Header Logging options are enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.12 Ensure all HTTP Header Logging options are enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.13 Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.13 Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.14 Ensure alerting after a threshold of credit card or Social Security numbers is detected is enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.14 Ensure alerting after a threshold of credit card or Social Security numbers is detected is enabled
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.15 Ensure a secure Data Filtering profile is applied to all security policies allowing traffic to or from the Internet
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.15 Ensure a secure Data Filtering profile is applied to all security policies allowing traffic to or from the Internet
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.16 Ensure that a Zone Protection Profile with an enabled SYN Flood Action of SYN Cookies is attached to all untrusted zones
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.16 Ensure that a Zone Protection Profile with an enabled SYN Flood Action of SYN Cookies is attached to all untrusted zones
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.17 Ensure that a Zone Protection Profile with tuned Flood Protection settings enabled for all flood types is attached to all untrusted zones
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.17 Ensure that a Zone Protection Profile with tuned Flood Protection settings enabled for all flood types is attached to all untrusted zones
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.18 Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.18 Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.19 Ensure all zones have Zone Protection Profiles that drop specially crafted packets
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.19 Ensure all zones have Zone Protection Profiles that drop specially crafted packets
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 6.20 Ensure that User Credential Submission uses the action of “block” or “continue” on the URL categories
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 6.20 Ensure that User Credential Submission uses the action of “block” or “continue” on the URL categories
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 7.1 Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 7.1 Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 7.2 Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 7.2 Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 7.3 Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 7.3 Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 8.1 Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 8.1 Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 8.2 Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 8.2 Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS
    test: true
    documentation_link: https://iron-skillet.readthedocs.io

  # 8.3 Ensure that the Certificate used for Decryption is Trusted
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: device_setting
        capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting

  - name: verify_update_service_enabled
    label: 8.3 Ensure that the Certificate used for Decryption is Trusted
    test: true
    documentation_link: https://iron-skillet.readthedocs.io
