# skillet preamble information used by panhandler
# ---------------------------------------------------------------------
# unique snippet name
name: CIS_benchmark_testing
# label used for menu selection
label: test CIS content
description: single capture and test for CIS validation creation and test

type: pan_validation

# grouping of like snippets for dynamic menu creation in panhandler
labels:
  collection:
    - CIS

variables:


snippets:

  # 5.5 Ensure all WildFire session information settings are enabled
  - name: device_config_file
    cmd: parse
    variable: config
    outputs:
      - name: wf_session_disabled_object
        capture_list: |-
          /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting/
          wildfire/session-info-select/*[text()='yes']

  - name: WF_session_info_enabled
    label: 5.5 Ensure all WildFire session information settings are enabled
    test: wf_session_disabled_object | length == 0
    fail_message: |-
      Session information settings not enabled:
      {%- for item in wf_session_disabled_object %}
        {%- for key in item %}
          {{ key }}
        {%- endfor %}
      {% endfor %}
    documentation_link: https://www.paloaltonetworks.com
