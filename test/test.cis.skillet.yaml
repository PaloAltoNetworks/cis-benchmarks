name: test_panos_validations_cis
label: test skillet for spot testing select validations
description: test skillet for spot testing select validations
type: pan_validation

# contains checks for device hardening, operational settings, logging, user access

variables:


snippets:

# Ensure 'Login Banner' is set
- name: capture_login_banner_test
  cmd: parse
  variable: config
  outputs:
    - name: login_banner_test
      capture_object: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/system/login-banner

- name: login_banner_set_test
  label: login banner raw validation
  test: login_banner_test | tag_present('login-banner')
  documentation_link: |-
    https://iron-skillet.readthedocs.io/en/docs_master/cis.html#ensure-login-banner-is-set

# 1.1.2 login banner set
- name: 1_1_2_login_banner_set_source_docs
  include: panos_validations_device_settings
  include_snippets:
    - name: capture_login_banner
    - name: login_banner_set
      label: |-
        login banner with includes using source doc link
      meta:
        scored: true
        level: 1
        section: 1

# 1.1.2 login banner set
- name: 1_1_2_login_banner_set
  include: panos_validations_device_settings
  include_snippets:
    - name: capture_login_banner
    - name: login_banner_set
      label: |-
        login banner with includes using local doc link
      meta:
        scored: true
        level: 1
        section: 1
      documentation_link: |-
        https://iron-skillet.readthedocs.io/en/docs_master/cis.html#ensure-login-banner-is-set